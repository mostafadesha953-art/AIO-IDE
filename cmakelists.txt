cmake_minimum_required(VERSION 3.10)
project(AIO_Smart_IDE LANGUAGES CXX)

set(CMAKE_CXX_STANDARD 17)
set(CMAKE_MSVC_RUNTIME_LIBRARY "MultiThreaded$<$<CONFIG:Debug>:Debug>")

# 1. البحث التلقائي عن كل ملفات البرمجة في كل المجلدات
file(GLOB_RECURSE SOURCES 
    "*.cpp" 
    "*.h" 
    "*.hpp"
)

# 2. التأكد من وجود ملفات قبل المتابعة
if(NOT SOURCES)
    message(FATAL_ERROR "Critical Error: No source files (.cpp) found in the entire repository!")
endif()

# 3. إعداد vcpkg
if(DEFINED ENV{VCPKG_INSTALLATION_ROOT})
    set(CMAKE_TOOLCHAIN_FILE "$ENV{VCPKG_INSTALLATION_ROOT}/scripts/buildsystems/vcpkg.cmake")
endif()

find_package(CURL REQUIRED)
find_package(nlohmann_json REQUIRED)

# 4. بناء البرنامج باستخدام الملفات التي وجدناها
add_executable(AIO_IDE ${SOURCES})

target_include_directories(AIO_IDE PRIVATE "${CMAKE_CURRENT_SOURCE_DIR}")
target_link_libraries(AIO_IDE PRIVATE CURL::libcurl nlohmann_json::nlohmann_json d3d11 dwmapi)
